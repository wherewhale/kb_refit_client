<script setup lang="ts">
import { reactive } from "vue";
import PointsCarousel from "~/components/points/Carousel.vue";
import HistoryBlock from "~/components/common/HistoryBlock.vue";
import { POINT_FILTERS } from "~/common/constant/filters";

// ν•„ν„° μ„ νƒ μƒνƒ
const selected = reactive({
  κΈ°κ°„: "1κ°μ›”",
  μΉ΄ν…κ³ λ¦¬: "μ „μ²΄",
  μ •λ ¬: "μµμ‹ μ",
});

const getIcon = (label: string): { background: string; emoji: string } => {
  if (label.includes("μ¤νƒ€ν¬μΈνΈ")) {
    return { background: "bg-green-1", emoji: "π’°" };
  } else if (label.includes("λ°°μ§€")) {
    return { background: "bg-blue-1", emoji: "π…" };
  } else if (label.includes("νƒ„μ†μ¤‘λ¦½")) {
    return { background: "bg-yellow-1", emoji: "π±" };
  } else {
    return { background: "bg-gray-1", emoji: "βοΈ" };
  }
};

// TODO: API μ—°λ™ν•΄μ„ μ‚¬μ©
const rewardList = [
  {
    id: 21,
    label: "νƒ„μ† ν¬μΈνΈ μ λ¦½",
    amount: 150,
    createdAt: new Date("2025-07-14T12:30:00"),
  },
  {
    id: 22,
    label: "νƒ„μ†μ¤‘λ¦½ ν¬μΈνΈ μ λ¦½",
    amount: 200,
    createdAt: new Date("2025-07-14T14:35:00"),
  },
  {
    id: 23,
    label: "λ°°μ§€ λ¦¬μ›λ“",
    amount: 100,
    createdAt: new Date("2025-07-14T18:50:00"),
  },
  {
    id: 24,
    label: "ν€΄μ¦ μ°Έμ—¬ μ¤νƒ€ν¬μΈνΈ μ λ¦½",
    amount: 100,
    createdAt: new Date("2025-07-15T10:05:00"),
  },
  {
    id: 25,
    label: "νƒ„μ† ν¬μΈνΈ μ λ¦½",
    amount: 150,
    createdAt: new Date("2025-07-15T13:15:00"),
  },
  {
    id: 26,
    label: "νƒ„μ†μ¤‘λ¦½ ν¬μΈνΈ μ λ¦½",
    amount: 100,
    createdAt: new Date("2025-07-15T17:40:00"),
  },
  {
    id: 27,
    label: "λ°°μ§€ λ¦¬μ›λ“",
    amount: 200,
    createdAt: new Date("2025-07-16T09:00:00"),
  },
  {
    id: 28,
    label: "ν€΄μ¦ μ°Έμ—¬ μ¤νƒ€ν¬μΈνΈ μ λ¦½",
    amount: 120,
    createdAt: new Date("2025-07-16T11:30:00"),
  },
  {
    id: 29,
    label: "νƒ„μ† ν¬μΈνΈ μ λ¦½",
    amount: 130,
    createdAt: new Date("2025-07-16T15:10:00"),
  },
  {
    id: 30,
    label: "νƒ„μ†μ¤‘λ¦½ ν¬μΈνΈ μ λ¦½",
    amount: 110,
    createdAt: new Date("2025-07-16T17:25:00"),
  },
];
</script>

<template>
  <main class="mt-10 pb-20">
    <component :is="PointsCarousel" />

    <div class="w-full rounded-lg bg-white p-6 mt-10 text-black">
      <FilterPanel
        :filters="POINT_FILTERS"
        :selected="selected"
        @update:selected="(value) => Object.assign(selected, value)"
      />
      <HistoryBlock
        :items="
          rewardList.map((item) => ({
            id: item.id,
            label: item.label,
            amount: item.amount,
            icon: getIcon(item.label),
            createdAt: item.createdAt,
          }))
        "
      />
    </div>
  </main>
</template>
